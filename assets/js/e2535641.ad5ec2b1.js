"use strict";(self.webpackChunkcitros_doc=self.webpackChunkcitros_doc||[]).push([[2001],{3905:(a,t,e)=>{e.d(t,{Zo:()=>l,kt:()=>y});var n=e(7294);function r(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function o(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,n)}return e}function i(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?o(Object(e),!0).forEach((function(t){r(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function s(a,t){if(null==a)return{};var e,n,r=function(a,t){if(null==a)return{};var e,n,r={},o=Object.keys(a);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||(r[e]=a[e]);return r}(a,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(r[e]=a[e])}return r}var d=n.createContext({}),c=function(a){var t=n.useContext(d),e=t;return a&&(e="function"==typeof a?a(t):i(i({},t),a)),e},l=function(a){var t=c(a.components);return n.createElement(d.Provider,{value:t},a.children)},m="mdxType",p={inlineCode:"code",wrapper:function(a){var t=a.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(a,t){var e=a.components,r=a.mdxType,o=a.originalType,d=a.parentName,l=s(a,["components","mdxType","originalType","parentName"]),m=c(e),u=r,y=m["".concat(d,".").concat(u)]||m[u]||p[u]||o;return e?n.createElement(y,i(i({ref:t},l),{},{components:e})):n.createElement(y,i({ref:t},l))}));function y(a,t){var e=arguments,r=t&&t.mdxType;if("string"==typeof a||r){var o=e.length,i=new Array(o);i[0]=u;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=a,s[m]="string"==typeof a?a:r,i[1]=s;for(var c=2;c<o;c++)i[c]=e[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,e)}u.displayName="MDXCreateElement"},1645:(a,t,e)=>{e.r(t),e.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=e(7462),r=(e(7294),e(3905));const o={toc_max_heading_level:4,hide_title:!0,sidebar_label:"Query Data"},i="Query Data",s={unversionedId:"snippets_doc/data_access/snippets_query_data",id:"snippets_doc/data_access/snippets_query_data",title:"Query Data",description:"Query All Data",source:"@site/docs_data_analysis/snippets_doc/data_access/snippets_query_data.md",sourceDirName:"snippets_doc/data_access",slug:"/snippets_doc/data_access/snippets_query_data",permalink:"/docs_data_analysis/next/snippets_doc/data_access/snippets_query_data",draft:!1,tags:[],version:"current",frontMatter:{toc_max_heading_level:4,hide_title:!0,sidebar_label:"Query Data"},sidebar:"dataAnalysisSidebar",previous:{title:"Batch Content",permalink:"/docs_data_analysis/next/snippets_doc/data_access/snippets_batch_content"},next:{title:"Plotting",permalink:"/docs_data_analysis/next/snippets_doc/data_access/snippets_plotting"}},d={},c=[{value:"Query All Data",id:"query-all-data",level:2},{value:"Query Exact Simulation",id:"query-exact-simulation",level:2},{value:"Query Several Simulations",id:"query-several-simulations",level:2},{value:"Query First <code>n</code> Messages",id:"query-first-n-messages",level:2},{value:"Query Every n-th Message",id:"query-every-n-th-message",level:2},{value:"Average Before Querying",id:"average-before-querying",level:2},{value:"Average",id:"average",level:3},{value:"Moving Average",id:"moving-average",level:3},{value:"Query Array Data",id:"query-array-data",level:2},{value:"Retrieve One Column",id:"retrieve-one-column",level:4},{value:"Retrieve Several Columns",id:"retrieve-several-columns",level:4},{value:"Divide Array By Columns",id:"divide-array-by-columns",level:4},{value:"Query Json-object Data",id:"query-json-object-data",level:2},{value:"Query Mixed Format Data",id:"query-mixed-format-data",level:2},{value:"Query Initial Parameters",id:"query-initial-parameters",level:2},{value:"Divide Tables by sid",id:"divide-tables-by-sid",level:2}],l={toc:c},m="wrapper";function p(a){let{components:t,...e}=a;return(0,r.kt)(m,(0,n.Z)({},l,e,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"query-data"},"Query Data"),(0,r.kt)("h2",{id:"query-all-data"},"Query All Data"),(0,r.kt)("p",null,"Query data from the batch 'my_batch' for topic 'my_topic':"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).data()\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-exact-simulation"},"Query Exact Simulation"),(0,r.kt)("p",null,"Query data from the batch 'my_batch' for topic 'my_topic' for the exact simulation id (sid) = 1:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).sid(1).data()\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-several-simulations"},"Query Several Simulations"),(0,r.kt)("p",null,"Query data from the batch 'my_batch' for topic 'my_topic' for simulation id (sid) = 1 and 2:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).sid([1, 2]).data()\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-first-n-messages"},"Query First ",(0,r.kt)("inlineCode",{parentName:"h2"},"n")," Messages"),(0,r.kt)("p",null,"Query first ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," messages of the each simulation from batch 'my_batch' for topic 'my_topic'. Parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"rid")," is a serial number (starts from 0) in each simulation and by method ",(0,r.kt)("inlineCode",{parentName:"p"},"rid()")," we can set the last rid to query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\nn = 5\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).rid(end = n-1).data()\nprint(df)\n")),(0,r.kt)("h2",{id:"query-every-n-th-message"},"Query Every n-th Message"),(0,r.kt)("p",null,"Query every n-th message of each simulation from batch 'my_batch' for topic 'my_topic':"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\nn = 5\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).skip(n).data()\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"average-before-querying"},"Average Before Querying"),(0,r.kt)("h3",{id:"average"},"Average"),(0,r.kt)("p",null,"Group and average every set of ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," consecutive messages of each simulation run and query averaged data from batch 'my_batch' for topic 'my_topic'. The queried column(s) must be numeric and explicitly specified."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ndata_column = 'my_column'\nn = 5\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).avg(n).data(data_column)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h3",{id:"moving-average"},"Moving Average"),(0,r.kt)("p",null,"Compute moving average with the window size equals ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," and then query each ",(0,r.kt)("inlineCode",{parentName:"p"},"s"),"-th message of the result. The queried column(s) must be numeric and explicitly specified."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ndata_column = 'my_column'\nn = 5\ns = 2\n# --------------------------- #\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).move_avg(n, s).data(data_column)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-array-data"},"Query Array Data"),(0,r.kt)("h4",{id:"retrieve-one-column"},"Retrieve One Column"),(0,r.kt)("p",null,"Let's consider a table for topic 'my_topic' from the batch 'my_batch', where each row under the 'data' column holds a dictionary (json-object) and within this dictionary, the key 'data' maps to a array of values, as shown:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"data"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{data: ","[1, 2, 3...]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{data: ","[4, 5, 6...]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"...")))),(0,r.kt)("p",null,"To extract the values from the first indexes from these arrays, follow these steps:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ncolumn_name = 'data.data[0]'\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\n# index starts from 0, so refer to the first index as \"[0]\"\ndf = citros.batch(batch_name).topic(topic_name).data(column_name)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h4",{id:"retrieve-several-columns"},"Retrieve Several Columns"),(0,r.kt)("p",null,"Let's consider a table for topic 'my_topic' from the batch 'my_batch', where each row under the 'data' column holds a dictionary and within this dictionary, the key 'val' maps to a list of values, as shown:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"data"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{val: ","[1, 2, 3...]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{val: ","[4, 5, 6...]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"...")))),(0,r.kt)("p",null,"To extract the values, for example, from the first and second indexes from these arrays, follow these steps:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ncolumn_names = ['data.val[0]', 'data.val[1]']\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\n# index starts from 0, so refer to the first index as \"[0]\" and to the second as \"[1]\"\ndf = citros.batch(batch_name).topic(topic_name).data(column_names)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h4",{id:"divide-array-by-columns"},"Divide Array By Columns"),(0,r.kt)("p",null,"Suppose for topic 'my_topic' from the batch 'my_batch' every row in the 'data' column contains a dictionary and within this dictionary, the 'data' key corresponds to a list that has a length of 3, as illustrated below:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"data"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{data: ","[1, 2, 3]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{data: ","[4, 5, 6]","}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"...")))),(0,r.kt)("p",null,"To extract these values into separate columns and label them as 'x', 'y', and 'z', proceed as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\n# --------------------------- #\n\nnew_column_names = ['x', 'y', 'z']\nquery = ['data.data['+str(i)+']' for i in range(len(new_column_names))]\n\ncitros = da.CitrosDB()\ndf = citros.batch(batch_name).topic(topic_name).data(query)\ndf.rename({query[i]: new_column_names[i] for i in range(len(query))}, axis = 1, inplace = True)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-json-object-data"},"Query Json-object Data"),(0,r.kt)("p",null,"For topic 'my_topic' from batch 'my_batch' consider a table where the 'data' column holds dictionaries with keys 'x', 'y', and 'z', as illustrated:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"data"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{x: 1, y: 2, z: 3}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{x: 4, y: 5, z: 6}")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"...")))),(0,r.kt)("p",null,"To retrieve only the data corresponding to the keys 'x' and 'y':"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ncolumn_names = ['data.x', 'data.y']\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\ndf = citros.batch(batch_name).topic(topic_name).data(column_names)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-mixed-format-data"},"Query Mixed Format Data"),(0,r.kt)("p",null,"If data has a very complex format, combining json-arrays and json-objects nested inside each other, for example like:"),(0,r.kt)("p",null,"|data                           |\n|-------------------------------\n|{coord: {v: [0, {w: ","[1]","} ] } } |\n|{coord: {v: [0, {w: ","[2]","} ] } } |\n|...                            |"),(0,r.kt)("p",null,"to retrieve values from array under the key 'w', batch is 'my_batch' and topic is 'my_topic':"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\ncolumn_name = 'data.coord.v[1].w[0]'\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\ndf = citros.batch(batch_name).topic(topic_name).data(column_name)\n\n#print first 5 rows of the obtained pandas.DataFrame\nprint(df.head(5))\n")),(0,r.kt)("h2",{id:"query-initial-parameters"},"Query Initial Parameters"),(0,r.kt)("p",null,"Initial parameters are stored in the topic '/config'. Its data can be accessed as data of the any other topic:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\ndf = citros.batch(batch_name).topic('/config').data()\nprint(df)\n")),(0,r.kt)("h2",{id:"divide-tables-by-sid"},"Divide Tables by sid"),(0,r.kt)("p",null,"Query the data and split the resulting pandas.DataFrame into several DataFrames based on the 'sid'. The outcome is a dictionary where each DataFrame is stored under a key corresponding to its 'sid'. Print all sids and pandas.DataFrame that corresponds to the sid = 0:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from citros_data_analysis import data_access as da\n\n# --- adjust to your data --- #\nbatch_name = 'my_batch'\ntopic_name = 'my_topic'\n# --------------------------- #\n\ncitros = da.CitrosDB()\n\ndfs = citros.batch(batch_name).topic(topic_name).data_dict()\nprint(f'sids = {list(dfs.keys())}')\nprint(dfs[0])\n")))}p.isMDXComponent=!0}}]);